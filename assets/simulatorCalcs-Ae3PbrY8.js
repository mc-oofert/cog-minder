import{v as re,i as B,H as x,I as oe}from"./index-kJFwoT1S.js";import{B as F}from"./botTypes-Cxei0LoN.js";import{C as M,S as te}from"./ItemPopover-6t6_KZG4.js";var X={exports:{}};X.exports;(function(e){var i=function(){var l=String.fromCharCode,t="ABCDEFGHIJKLMNOPQRSTUVWXYZabcdefghijklmnopqrstuvwxyz0123456789+/=",m="ABCDEFGHIJKLMNOPQRSTUVWXYZabcdefghijklmnopqrstuvwxyz0123456789+-$",I={};function v(r,o){if(!I[r]){I[r]={};for(var u=0;u<r.length;u++)I[r][r.charAt(u)]=u}return I[r][o]}var f={compressToBase64:function(r){if(r==null)return"";var o=f._compress(r,6,function(u){return t.charAt(u)});switch(o.length%4){default:case 0:return o;case 1:return o+"===";case 2:return o+"==";case 3:return o+"="}},decompressFromBase64:function(r){return r==null?"":r==""?null:f._decompress(r.length,32,function(o){return v(t,r.charAt(o))})},compressToUTF16:function(r){return r==null?"":f._compress(r,15,function(o){return l(o+32)})+" "},decompressFromUTF16:function(r){return r==null?"":r==""?null:f._decompress(r.length,16384,function(o){return r.charCodeAt(o)-32})},compressToUint8Array:function(r){for(var o=f.compress(r),u=new Uint8Array(o.length*2),c=0,g=o.length;c<g;c++){var y=o.charCodeAt(c);u[c*2]=y>>>8,u[c*2+1]=y%256}return u},decompressFromUint8Array:function(r){if(r==null)return f.decompress(r);for(var o=new Array(r.length/2),u=0,c=o.length;u<c;u++)o[u]=r[u*2]*256+r[u*2+1];var g=[];return o.forEach(function(y){g.push(l(y))}),f.decompress(g.join(""))},compressToEncodedURIComponent:function(r){return r==null?"":f._compress(r,6,function(o){return m.charAt(o)})},decompressFromEncodedURIComponent:function(r){return r==null?"":r==""?null:(r=r.replace(/ /g,"+"),f._decompress(r.length,32,function(o){return v(m,r.charAt(o))}))},compress:function(r){return f._compress(r,16,function(o){return l(o)})},_compress:function(r,o,u){if(r==null)return"";var c,g,y={},k={},E="",z="",A="",C=2,P=3,p=2,a=[],n=0,s=0,d;for(d=0;d<r.length;d+=1)if(E=r.charAt(d),Object.prototype.hasOwnProperty.call(y,E)||(y[E]=P++,k[E]=!0),z=A+E,Object.prototype.hasOwnProperty.call(y,z))A=z;else{if(Object.prototype.hasOwnProperty.call(k,A)){if(A.charCodeAt(0)<256){for(c=0;c<p;c++)n=n<<1,s==o-1?(s=0,a.push(u(n)),n=0):s++;for(g=A.charCodeAt(0),c=0;c<8;c++)n=n<<1|g&1,s==o-1?(s=0,a.push(u(n)),n=0):s++,g=g>>1}else{for(g=1,c=0;c<p;c++)n=n<<1|g,s==o-1?(s=0,a.push(u(n)),n=0):s++,g=0;for(g=A.charCodeAt(0),c=0;c<16;c++)n=n<<1|g&1,s==o-1?(s=0,a.push(u(n)),n=0):s++,g=g>>1}C--,C==0&&(C=Math.pow(2,p),p++),delete k[A]}else for(g=y[A],c=0;c<p;c++)n=n<<1|g&1,s==o-1?(s=0,a.push(u(n)),n=0):s++,g=g>>1;C--,C==0&&(C=Math.pow(2,p),p++),y[z]=P++,A=String(E)}if(A!==""){if(Object.prototype.hasOwnProperty.call(k,A)){if(A.charCodeAt(0)<256){for(c=0;c<p;c++)n=n<<1,s==o-1?(s=0,a.push(u(n)),n=0):s++;for(g=A.charCodeAt(0),c=0;c<8;c++)n=n<<1|g&1,s==o-1?(s=0,a.push(u(n)),n=0):s++,g=g>>1}else{for(g=1,c=0;c<p;c++)n=n<<1|g,s==o-1?(s=0,a.push(u(n)),n=0):s++,g=0;for(g=A.charCodeAt(0),c=0;c<16;c++)n=n<<1|g&1,s==o-1?(s=0,a.push(u(n)),n=0):s++,g=g>>1}C--,C==0&&(C=Math.pow(2,p),p++),delete k[A]}else for(g=y[A],c=0;c<p;c++)n=n<<1|g&1,s==o-1?(s=0,a.push(u(n)),n=0):s++,g=g>>1;C--,C==0&&(C=Math.pow(2,p),p++)}for(g=2,c=0;c<p;c++)n=n<<1|g&1,s==o-1?(s=0,a.push(u(n)),n=0):s++,g=g>>1;for(;;)if(n=n<<1,s==o-1){a.push(u(n));break}else s++;return a.join("")},decompress:function(r){return r==null?"":r==""?null:f._decompress(r.length,32768,function(o){return r.charCodeAt(o)})},_decompress:function(r,o,u){var c=[],g=4,y=4,k=3,E="",z=[],A,C,P,p,a,n,s,d={val:u(0),position:o,index:1};for(A=0;A<3;A+=1)c[A]=A;for(P=0,a=Math.pow(2,2),n=1;n!=a;)p=d.val&d.position,d.position>>=1,d.position==0&&(d.position=o,d.val=u(d.index++)),P|=(p>0?1:0)*n,n<<=1;switch(P){case 0:for(P=0,a=Math.pow(2,8),n=1;n!=a;)p=d.val&d.position,d.position>>=1,d.position==0&&(d.position=o,d.val=u(d.index++)),P|=(p>0?1:0)*n,n<<=1;s=l(P);break;case 1:for(P=0,a=Math.pow(2,16),n=1;n!=a;)p=d.val&d.position,d.position>>=1,d.position==0&&(d.position=o,d.val=u(d.index++)),P|=(p>0?1:0)*n,n<<=1;s=l(P);break;case 2:return""}for(c[3]=s,C=s,z.push(s);;){if(d.index>r)return"";for(P=0,a=Math.pow(2,k),n=1;n!=a;)p=d.val&d.position,d.position>>=1,d.position==0&&(d.position=o,d.val=u(d.index++)),P|=(p>0?1:0)*n,n<<=1;switch(s=P){case 0:for(P=0,a=Math.pow(2,8),n=1;n!=a;)p=d.val&d.position,d.position>>=1,d.position==0&&(d.position=o,d.val=u(d.index++)),P|=(p>0?1:0)*n,n<<=1;c[y++]=l(P),s=y-1,g--;break;case 1:for(P=0,a=Math.pow(2,16),n=1;n!=a;)p=d.val&d.position,d.position>>=1,d.position==0&&(d.position=o,d.val=u(d.index++)),P|=(p>0?1:0)*n,n<<=1;c[y++]=l(P),s=y-1,g--;break;case 2:return z.join("")}if(g==0&&(g=Math.pow(2,k),k++),c[s])E=c[s];else if(s===y)E=C+C.charAt(0);else return null;z.push(E),c[y++]=C+E.charAt(0),g--,C=E,g==0&&(g=Math.pow(2,k),k++)}}};return f}();e!=null&&(e.exports=i)})(X);var se=X.exports;const Me=re(se),ae=10,le=95,ce=100,fe=1e5,Ae=new Map([["Huge",30],["Large",10],["Medium",0],["Small",-10],["Tiny",-30]]),Y=["Phase Wall","Vortex Field Projector","7V-RTL'S Ultimate Field","Force Field","Imp. Force Field","Adv. Force Field","Exp. Force Field","Shield Generator","Imp. Shield Generator","Adv. Shield Generator","Exp. Shield Generator","Stasis Bubble","Stasis Trap","Remote Shield","Imp. Remote Shield","Remote Force Field","Imp. Remote Force Field","Energy Mantle","Imp. Energy Mantle","AEGIS Remote Shield"],$=new Map([["Remote Shield",.75],["Stasis Trap",.75],["Phase Wall",.5],["Remote Force Field",.5],["Stasis Bubble",.5]]),V=[4,6,8],Ie=[.2,.3,.4],Pe=60,De=70,b=[5,6,8,12],Re=[2,3,4,6],ke=new Map([["No Siege",{bonus:0,tus:0}],["In Siege Mode",{bonus:20,tus:0}],["In High Siege Mode",{bonus:30,tus:0}],["Entering Siege Mode",{bonus:20,tus:500}],["Entering High Siege Mode",{bonus:30,tus:500}]]),ue={"Wide (10)":10,"Intermediate (30)":30,"Narrow (50)":50,"Fine (100)":100},ee={1:200,2:300,3:325,4:350,5:375,6:400};function J(e,i,l,t,m,I,v,f,r,o,u,c){const g=[],y=Math.trunc(l/t);if(I)for(let a=0;a<t;a++)g.push({armorAnalyzed:!1,critical:void 0,coreBonus:0,damageType:u,disruptChance:0,forceCore:!1,originalDamage:y,realDamage:0,salvage:c,spectrum:0});else for(let a=0;a<t;a++)g.push({armorAnalyzed:v,coreBonus:e.offensiveState.coreAnalyzerChance,critical:m,damageType:u,disruptChance:f,forceCore:!1,originalDamage:y,realDamage:0,salvage:c,spectrum:r});const k=O(i.defensiveState.damageReduction),E=k!=null?k.reduction:1;if(k!==void 0&&k.remote)for(const a of g)a.realDamage=a.originalDamage-Math.trunc(a.originalDamage*(1-E));else for(const a of g)a.realDamage=Math.trunc(a.originalDamage*E);function z(a){if(a.def.slot!=="Power")return;const n=a.def;if(n.explosionDamageMax>0&&n.explosionType!==void 0){const s=x(n.explosionDamageMin,n.explosionDamageMax),d=x(n.minChunks??0,n.maxChunks??0),j=Math.trunc(s/d);i.salvage+=n.explosionSalvage;for(let T=0;T<d;T++)A(0,j,n.explosionType,void 0,!1,!1,n.explosionDisruption,ye(n.explosionSpectrum),!1)}}function A(a,n,s,d,j,T,R,H,U){const{part:w,partIndex:K}=pe(i,a,s,j,T,U);p(n,s,d,R,H,j,w,K)}function C(a,n,s,d,j){if(i.parts.splice(a,1),i.armorAnalyzedCoverage-=n.armorAnalyzedCoverage,i.armorAnalyzedSiegedCoverage-=n.armorAnalyzedSiegedCoverage,i.siegedCoverage-=n.siegedCoverage,i.totalCoverage-=n.coverage,n.resistances!==void 0)for(const T of Object.keys(n.resistances))T in i.resistances&&(i.resistances[T]-=n.resistances[T]);if(s>0&&!n.protection&&o&&m===void 0&&A(0,s,d,void 0,!0,!1,0,0,!1),d==="Impact"){let T=x(50,150);T=q(i,T,"Electromagnetic"),P(T)}j==="CriticalRemove"&&n.integrity>0&&n.def.type!=="Processor"&&n.def.type!=="Hackware"&&(e.lootState.items[n.initialIndex].numDrops+=1,e.lootState.items[n.initialIndex].totalCritRemoves+=1,e.lootState.items[n.initialIndex].totalIntegrity+=n.integrity),n.integrity=0,S(e)}function P(a){let n=O(i.defensiveState.corruptionPrevent);for(;a>0&&n!==void 0;){const s=Math.ceil(n.part.integrity/2);if(s<a)n.part.integrity-=a*=2,a=0;else{i.defensiveState.corruptionPrevent.shift();const d=i.parts.indexOf(n.part);C(d,n.part,0,"Entropic","Integrity"),n=O(i.defensiveState.corruptionPrevent),a-=s}}i.corruption+=a}function p(a,n,s,d,j,T,R,H){function U(h){return h===M.Destroy||h===M.Smash}if(s!==void 0&&(i.immunities.includes(F.Criticals)||O(i.defensiveState.critImmunity)!==void 0)&&(s=void 0),s===M.Meltdown&&!i.immunities.includes(F.Meltdown)){i.coreIntegrity=0;return}else if(s===M.Intensify)a*=2;else if(s===M.Impale)a*=2,e.tus+=100;else if(s===M.Detonate){let h;for(h=0;h<i.parts.length&&i.parts[h].def.slot!=="Power";h++);if(h<i.parts.length){const D=i.parts[h];if(C(h,D,0,"Entropic","Integrity"),z(D),h===H)return}}else((s===M.Sever||s===M.Sunder)&&i.immunities.includes(F.Dismemberment)||s===M.Phase&&(i.immunities.includes(F.Coring)||L(i,"Core")===void 0))&&(s=void 0);if(R===void 0){const h=T?void 0:L(i,"Core");if((s===M.Destroy||s==M.Phase||s==M.Smash||s==M.Sunder||s==M.Sever)&&(i.immunities.includes(F.Coring)||h!==void 0)&&(s=void 0),h!=null){const D=Math.trunc(h.reduction*a);if(h.part.integrity-=D,h.part.integrity<=0){const _=i.parts.indexOf(h.part);C(_,h.part,0,"Entropic","Integrity")}a=a-D}if(s===M.Destroy||s===M.Smash?i.coreIntegrity=0:i.coreIntegrity-=a,i.coreIntegrity===0)return;if(!i.immunities.includes(F.Disruption)&&x(0,99)<d/2&&(i.coreDisrupted=!0),s===M.Sever||s===M.Sunder){const D=s===M.Sunder?x(1,2):1;for(let _=0;_<D;_++){const{part:W,partIndex:ne}=Z(i,void 0);W===void 0||L(i,W.def.slot)!==void 0||W.def.size>1||(W.integrity-=Math.trunc(W.def.integrity*x(5,25)/100),C(ne,W,0,"Phasic","CriticalRemove"))}return}else if(s===M.Blast){const{part:D,partIndex:_}=Z(i,void 0);if(D===void 0||L(i,D.def.slot)!==void 0)return;D.def.size===1?(p(a,"Phasic",void 0,0,0,!1,D,_),D.integrity>0&&!i.immunities.includes(F.Dismemberment)&&C(_,D,0,"Phasic","CriticalRemove")):p(a,"Phasic",void 0,0,0,!1,D,_)}else if(s===M.Phase){const{part:D,partIndex:_}=Z(i,void 0);p(a,"Phasic",void 0,0,0,!1,D,_)}return}const w=R.def.type==="Protection"||T?void 0:L(i,R.def.slot);w!==void 0&&U(s)&&(s=void 0);const K=R.def.slot==="Power"&&x(0,99)<j;if((U(s)&&R.protection||i.sieged&&R.def.type==="Treads"&&R.def.siege!==void 0)&&(s=void 0,a=Math.trunc(1.2*a)),R.selfDamageReduction!==0?a=Math.trunc(a*R.selfDamageReduction):R.def.type==="Treads"&&R.def.siege!==void 0&&i.sieged&&(a=Math.trunc(a*(R.def.siege===te.High?.5:.75))),w!=null){const h=Math.trunc(w.reduction*a);if(w.part.integrity-=h,w.part.integrity<=0){const D=i.parts.indexOf(w.part);C(D,w.part,0,"Entropic","Integrity")}a=a-h}const G=R.integrity<=a||U(s)||K;if(!G&&(s===M.Sever||s===M.Sunder)&&R.def.size===1&&w===void 0&&(G||C(H,R,0,"Slashing","CriticalRemove")),G){const h=s===M.Smash?a:a-R.integrity;C(H,R,h,n,"Integrity")}else R.integrity-=a;const ie=H;if(s===M.Blast){const{part:h,partIndex:D}=Z(i,G?ie:void 0);if(h===void 0||w!==void 0)return;h.def.size===1?(p(a,"Phasic",void 0,0,0,!1,h,D),h.integrity>0&&!i.immunities.includes(F.Dismemberment)&&C(D,h,0,"Phasic","CriticalRemove")):p(a,"Phasic",void 0,0,0,!1,h,D)}else s===M.Phase&&p(a,"Phasic",void 0,0,0,!1,void 0,-1);K&&z(R)}i.salvage+=c;for(const a of g){if(a.realDamage===0)return;if(A(a.coreBonus,a.realDamage,a.damageType,a.critical,!1,a.forceCore,a.disruptChance,a.spectrum,a.armorAnalyzed),u==="Electromagnetic"){const n=O(i.defensiveState.corruptionIgnore),s=m===M.Corrupt&&!i.immunities.includes(F.Criticals);if(n===void 0||x(0,99)>=n.chance){const d=s?1.5:x(50,150)/100,j=a.originalDamage*d;P(j)}}}}function de(e){const i={};for(const t of Object.keys(e.resistances))i[t]=e.resistances[t];const l={armorAnalyzedCoverage:e.armorAnalyzedCoverage,armorAnalyzedSiegedCoverage:e.armorAnalyzedSiegedCoverage,behavior:e.behavior,coreCoverage:e.coreCoverage,coreDisrupted:e.coreDisrupted,coreIntegrity:e.coreIntegrity,corruption:e.corruption,def:e.def,defensiveState:void 0,externalDamageReduction:e.externalDamageReduction,immunities:e.immunities,initialCoreIntegrity:e.initialCoreIntegrity,parts:e.parts.map(t=>({armorAnalyzedSiegedCoverage:t.armorAnalyzedSiegedCoverage,armorAnalyzedCoverage:t.armorAnalyzedCoverage,coverage:t.coverage,def:t.def,integrity:t.integrity,initialIndex:t.initialIndex,protection:t.protection,selfDamageReduction:t.selfDamageReduction,siegedCoverage:t.siegedCoverage})),regen:e.regen,resistances:i,running:e.running,runningEvasion:e.runningEvasion,runningMomentum:e.runningMomentum,salvage:0,sieged:e.sieged,siegedCoverage:e.siegedCoverage,tusToSiege:e.tusToSiege,totalCoverage:e.totalCoverage};return l.defensiveState=ge(l.parts,l.externalDamageReduction),l}function q(e,i,l){return l in e.resistances?Math.trunc(i*(1-e.resistances[l]/100)):i}function ge(e,i){const l={antimissile:[],avoid:[],corruptionIgnore:[],corruptionPrevent:[],corruptionReduce:[],critImmunity:[],damageReduction:[],rangedAvoid:[],shieldings:{Core:[],"N/A":[],Power:[],Propulsion:[],Utility:[],Weapon:[]}};for(const t of e)if(B(t.def,!0,"AntimissileChance"))l.antimissile.push({chance:t.def.specialProperty.trait.chance,part:t});else if(B(t.def,!0,"ReactionControlSystem"))l.avoid.push({legs:t.def.specialProperty.trait.legsChance,other:t.def.specialProperty.trait.chance,part:t});else if(B(t.def,!0,"CorruptionIgnore"))l.corruptionIgnore.push({chance:t.def.specialProperty.trait.chance,part:t});else if(B(t.def,!0,"CorruptionPrevent"))l.corruptionPrevent.push({part:t});else if(B(t.def,!0,"CorruptionReduce"))l.corruptionReduce.push({amount:t.def.specialProperty.trait.amount,part:t});else if(B(t.def,!0,"CriticalImmunity"))l.critImmunity.push({part:t});else if(B(t.def,!0,"DamageReduction"))l.damageReduction.push({reduction:t.def.specialProperty.trait.multiplier,remote:t.def.specialProperty.trait.remote,part:t});else if(B(t.def,!0,"DamageResists"))t.resistances=t.def.specialProperty.trait.resists;else if(B(t.def,!0,"RangedAvoid"))l.rangedAvoid.push({avoid:t.def.specialProperty.trait.avoid,part:t});else if(B(t.def,!0,"SelfReduction"))t.selfDamageReduction=t.def.specialProperty.trait.shielding;else if(B(t.def,!0,"Shielding")){const m=t.def.specialProperty.trait;l.shieldings[m.slot].push({reduction:m.shielding,part:t})}if($.has(i)){const t=$.get(i)||1,m=i.includes("Remote");if(l.damageReduction.length===0)l.damageReduction.push({reduction:t,remote:m,part:{armorAnalyzedSiegedCoverage:0,armorAnalyzedCoverage:0,coverage:0,def:void 0,integrity:1,initialIndex:0,protection:!1,selfDamageReduction:0,siegedCoverage:0}});else{const I=Y.indexOf(l.damageReduction[0].part.def.name);Y.indexOf(i)<I?l.damageReduction.unshift({reduction:t,remote:m,part:{armorAnalyzedCoverage:0,armorAnalyzedSiegedCoverage:0,coverage:0,def:void 0,integrity:1,initialIndex:0,protection:!1,selfDamageReduction:0,siegedCoverage:0}}):l.damageReduction.push({remote:m,reduction:t,part:{armorAnalyzedCoverage:0,armorAnalyzedSiegedCoverage:0,coverage:0,def:void 0,initialIndex:0,integrity:1,protection:!1,selfDamageReduction:0,siegedCoverage:0}})}}return l}function O(e){let i;for(;e.length>0;)if(e[0].part.integrity>0){i=e[0];break}else e.shift();return i}function pe(e,i,l,t,m,I){let v,f=-1;if(m)return{part:v,partIndex:f};if(l==="Impact"){let r=x(0,e.parts.map(o=>o.def.size).reduce(oe,0));for(let o=0;o<e.parts.length;o++){if(r<e.parts[o].def.size){f=o;break}r-=e.parts[o].def.size}f>=0&&(v=e.parts[f])}else if(t){const r=e.parts.filter(o=>o.protection&&o.coverage>0);if(r.length>0){let o=x(0,r.reduce((u,c)=>u+c.coverage,0));for(let u=0;u<r.length;u++)if(o-=r[u].coverage,o<0){v=r[u];break}f=e.parts.indexOf(v)}}if(v===void 0&&l!=="Impact"){let r;if(I?e.sieged?r=e.armorAnalyzedSiegedCoverage:r=e.armorAnalyzedCoverage:e.sieged?r=e.siegedCoverage:r=e.totalCoverage,l=="Piercing"&&(i+=8),i>0){r-=e.coreCoverage;const u=Math.min(e.coreCoverage/e.totalCoverage+i/100,.999),c=e.totalCoverage*u;r+=c}let o=x(0,r-1);for(f=0;f<e.parts.length;f++)if(I?e.sieged?o-=e.parts[f].armorAnalyzedSiegedCoverage:o-=e.parts[f].armorAnalyzedCoverage:e.sieged?o-=e.parts[f].siegedCoverage:o-=e.parts[f].coverage,o<0){v=e.parts[f];break}}return{part:v,partIndex:f}}function Z(e,i){let l=x(0,e.parts.length-1-(i===void 0?0:1));return i!==void 0&&i>0&&l>=i&&(l+=1),l>=e.parts.length?{part:void 0,partIndex:-1}:{part:e.parts[l],partIndex:l}}function me(e,i){let l=0;return e.recoil!==void 0&&(l+=e.recoil,l-=i),Math.max(l,0)}function Ee(e,i){let l;if(e.length===0)return 0;e.length in ee?l=ee[e.length]:l=400;for(const t of e)l+=t.delay??0;return l*=i,Math.trunc(Math.max(25,l))}function L(e,i){return O(e.defensiveState.shieldings[i])}function N(e){let i=e.corruption;for(const l of e.defensiveState.corruptionReduce)l.part.integrity>=0&&(i-=l.amount);return i}const ve={Kill:{volleyEndCondition:function(e){return e.coreIntegrity<=0||N(e)>=100},projectileEndCondition:function(e){return e.coreIntegrity<=0}},"Kill or Core Disrupt":{projectileEndCondition:function(e){return e.coreIntegrity<=0},volleyEndCondition:function(e){return e.coreIntegrity<=0||N(e)>=100||e.coreDisrupted}},"Kill or No Power":{projectileEndCondition:function(e){return e.coreIntegrity<=0},volleyEndCondition:function(e){return e.coreIntegrity<=0||N(e)>=100||e.parts.every(i=>i.def.slot!="Power")}},"Kill or No Weapons":{projectileEndCondition:function(e){return e.coreIntegrity<=0},volleyEndCondition:function(e){return e.coreIntegrity<=0||N(e)>=100||e.parts.every(i=>i.def.slot!="Weapon")}},"Kill or No TNC":{projectileEndCondition:function(e){return e.coreIntegrity<=0},volleyEndCondition:function(e){return e.coreIntegrity<=0||N(e)>=100||e.parts.every(i=>i.def.name!="Transport Network Coupler")}},Tele:{projectileEndCondition:function(e){return e.coreIntegrity<=0},volleyEndCondition:function(e){return e.coreIntegrity<=e.initialCoreIntegrity*.8||e.parts.filter(i=>i.def.slot==="Weapon").length===1||e.parts.filter(i=>i.def.slot==="Propulsion").length===1}}};function Te(e){const i=de(e.initialBotState);e.botState=i;const l=e.offensiveState;let t=0,m=0;e.tus=0,e.actionNum=0,S(e);const I=ve[e.endCondition];l.sneakAttack=l.sneakAttackStrategy==="All"||l.sneakAttackStrategy==="First Only",l.momentum.current=l.momentum.bonus+l.momentum.initial;let v=!1;for(;!v;){const r=Math.trunc(m/100),o=Math.trunc(e.tus/100),u=i.regen*(o-r);i.coreIntegrity=Math.min(i.initialCoreIntegrity,i.coreIntegrity+u),t+=1;let c=l.volleyTime;if(l.melee){v=Q(e,e.weapons[0],I.projectileEndCondition),e.actionNum+=1,e.actionNum<=2&&S(e);for(let y=1;y<e.weapons.length&&!v;y++)x(0,99)<l.followupChances[y-1]&&(v=Q(e,e.weapons[y],I.projectileEndCondition),c+=.5*e.weapons[y].delay);c*=l.volleyTimeModifier,t===1&&(l.sneakAttackStrategy==="First Only"&&(l.sneakAttack=!1),l.momentum.current=l.momentum.bonus)}else{let y=!0;for(const k of e.weapons){if(v=Q(e,k,I.projectileEndCondition),v)break;y&&(y=!1,e.actionNum+=1,e.actionNum<=2&&S(e))}}if(t>=fe)return!1;l.ramming&&(c=Math.max(100,l.speed)),m=e.tus,e.tus+=c;let g=!1;!l.melee&&m<l.siegeBonus.tus&&e.tus>=l.siegeBonus.tus&&(g=!0),m<i.tusToSiege&&e.tus>=i.tusToSiege&&i.behavior==="Siege/Fight"&&i.parts.find(y=>y.def.type==="Treads"&&y.def.siege!==void 0)!==void 0&&(i.sieged=!0,g=!0),i.behavior==="Run When Hit"&&i.runningMomentum<3&&(i.running=!0,i.runningMomentum=Math.min(Math.trunc(e.tus/i.def.speed),3)),g&&S(e),v=I.volleyEndCondition(i)}t in e.killVolleys?e.killVolleys[t]+=1:e.killVolleys[t]=1,e.tus in e.killTus?e.killTus[e.tus]+=1:e.killTus[e.tus]=1;for(const r of i.parts)if(r.integrity>0){const o=e.lootState.items[r.initialIndex];let u=x(0,99)<r.integrity/r.def.integrity*100/2+i.salvage;const c=N(i);u&&c>0&&x(0,99)<c-r.def.integrity&&(o.totalFried+=1,u=!1),u&&(o.totalIntegrity+=r.integrity,o.numDrops+=1,x(0,99)<c&&(o.totalCorruptionPercent+=x(1,Math.min(10*c/100,15))))}e.lootState.numKills+=1;let f=x(i.def.salvageLow,i.def.salvageHigh);return f+=i.salvage,f=Math.max(0,f),f=Math.min(f,i.def.salvageHigh),e.lootState.matterDrop+=f,!0}function Q(e,i,l){const t=e.botState,m=e.offensiveState;if(m.ramming){const I=100/e.offensiveState.speed*100;let v=((10+i.def.mass)/5+1)*(I/100)*Math.max(e.offensiveState.momentum.current,1);v=Math.min(100,v);let f=x(0,v);return f=q(t,f,"Impact"),f>0&&J(e,t,f,1,void 0,!1,!1,!1,!1,!0,"Impact",3),l(t)}for(let I=0;I<i.numProjectiles;I++){let v=m.melee&&m.sneakAttack||x(0,99)<i.accuracy;if(v&&i.isMissile){const f=O(t.defensiveState.antimissile);if(f!=null){const r=f.chance,o=Math.min(4,m.distance);for(let u=0;u<o;u++)if(x(0,99)<r){v=!1;break}}}if(v){if(i.def.type==="Ballistic Cannon"&&(i.def.salvage??0)<-2&&(e.lootState.matterBlasted+=Math.trunc(x(0,-i.def.salvage))),i.damageType!=null){let f=x(i.damageMin,i.damageMax);if(i.overloaded&&(f=Math.trunc(f*2)),m.melee&&m.momentum.current>0){const u=100/m.speed*100;let c=m.momentum.current*u/1200*40;c=Math.trunc(c),c=Math.max(1,c),c=Math.min(40,c),i.damageType==="Piercing"&&(c*=2),c=c/100+1,f=Math.trunc(c*f)}m.melee&&m.sneakAttack&&(f*=2),m.analysis&&(f=Math.trunc(1.1*f)),i.accelerated&&(f=Math.trunc(m.chargerBonus*f)),f=q(t,f,i.damageType);const r=x(0,99)<m.armorAnalyzerChance,o=x(0,99)<i.criticalChance;if(f>0&&(J(e,t,f,1,o?i.criticalType:void 0,!1,r,i.disruption,i.spectrum,i.overflow,i.damageType,i.salvage),l(t)))return!0}if(i.explosionType!=null){let f=x(i.explosionMin,i.explosionMax);f=q(t,f,i.explosionType);const r=x(i.explosionChunksMin,i.explosionChunksMax);if(f>0&&(J(e,t,f,r,void 0,!0,!1,i.explosionDisruption,0,i.overflow,i.explosionType,i.salvage),l(t)))return!0}}}return!1}function ye(e){return e===void 0?0:ue[e]}function S(e){const i=e.offensiveState,l=e.botState;let t=0;const I=l.def.movement;(I.includes("Hovering")||I.includes("Flying"))&&(t-=10);const v=O(l.defensiveState.avoid);v!=null&&(I.includes("Walking")?t-=v.legs:t-=v.other),i.analysis&&(t+=5);let f=0;if(i.melee){for(let o=0;o<b.length;o++)t+=i.meleeAnalysis[o]*b[o];let r=0;for(let o=i.forceBoosters.length-1;o>=0;o--)i.forceBoosters[o]==2?(t-=1.5*V[o],r+=2):i.forceBoosters[o]==1&&(t-=V[o]*r==0?1:.5,r+=1)}else{t+=i.distance<6?(6-i.distance)*3:0;const r=i.siegeBonus;e.tus>=r.tus&&(f=r.bonus),t+=f;const o=O(l.defensiveState.rangedAvoid);o!=null&&(t-=o.avoid)}e.actionNum===0?t+=e.offensiveState.action1Accuracy:e.actionNum===1?t+=e.offensiveState.action2Accuracy:t+=10,l.sieged&&(t+=20),l.running&&(l.parts.find(r=>r.def.type==="Leg")!==void 0&&(t-=5*l.runningMomentum),t-=l.runningEvasion);for(const r of e.weapons){if(r.def.waypoints!==void 0){r.accuracy=100;return}let o=r.baseAccuracy+t;!i.melee&&f===0&&(o-=i.recoil-me(r.def,i.recoilReduction));const u=i.melee?ce:le;r.accuracy=Math.min(u,Math.max(o,ae))}}export{Me as L,ge as a,me as b,Ae as c,ye as d,Te as e,fe as f,Ee as g,Pe as h,De as i,Ie as j,Re as m,ke as s,ee as v};
